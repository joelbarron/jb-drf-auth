# i18n Guide

This guide explains how to enable translated `jb-drf-auth` messages in integrator projects.

## What happens if you skip i18n?

- The library still works normally.
- User-facing messages are returned in their base language (currently mostly Spanish).
- `Accept-Language` will not switch messages to another language.

So i18n is optional for functionality, but required for multilingual UX.

## 1) Enable i18n in Django settings

```python
USE_I18N = True
LANGUAGE_CODE = "es-mx"

LANGUAGES = (
    ("es", "Spanish"),
    ("en", "English"),
)

LOCALE_PATHS = [
    BASE_DIR / "locale",  # adapt to your project path style
]
```

## 2) Enable LocaleMiddleware

`LocaleMiddleware` must be present and placed before `CommonMiddleware`.

```python
MIDDLEWARE = [
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.locale.LocaleMiddleware",
    "django.middleware.common.CommonMiddleware",
    # ...
]
```

## 3) Install gettext tooling

Required by `makemessages` and `compilemessages`.

- macOS (Homebrew): `brew install gettext`
- Debian/Ubuntu: `sudo apt-get install -y gettext`

## 4) Generate message catalogs

From project root:

```bash
django-admin makemessages -l es
django-admin makemessages -l en
```

This creates/updates `.po` files under `locale/<lang>/LC_MESSAGES/django.po`.

## 5) Translate strings

Edit generated `.po` files and fill `msgstr` values.

Example:

```po
msgid "Credenciales invalidas."
msgstr "Invalid credentials."
```

## 6) Compile translations

```bash
django-admin compilemessages
```

This generates `.mo` files used at runtime.

## 7) Test by language

Call endpoints with:

- `Accept-Language: es`
- `Accept-Language: en`

and verify translated response messages.

## 8) Production checklist

- Ensure `locale/` files are included in your deploy artifact/container.
- Run `compilemessages` during build or release.
- Recompile whenever `.po` files change.

## Troubleshooting

### `makemessages` fails

Usually missing `gettext` binaries. Install system package and retry.

### Translations do not change

Check:

1. `USE_I18N = True`
2. `LocaleMiddleware` enabled
3. `.po` contains translated `msgstr`
4. `compilemessages` executed after edits
5. request includes `Accept-Language`
